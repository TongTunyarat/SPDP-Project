<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Dashboard </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/CSS/sidebar-admin.css">
    <link rel="stylesheet" href="/CSS/addNewProject.css">

    <!-- Library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<div class="container">
    <div class="sidebar">
        <h2>ICT MAHIDOL</h2>
        <ul>
            <h4>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48"
                     style="fill:#FFFFFF;">
                    <path
                            d="M39.5,43h-9c-1.381,0-2.5-1.119-2.5-2.5v-9c0-1.105-0.895-2-2-2h-4c-1.105,0-2,0.895-2,2v9c0,1.381-1.119,2.5-2.5,2.5h-9	C7.119,43,6,41.881,6,40.5V21.413c0-2.299,1.054-4.471,2.859-5.893L23.071,4.321c0.545-0.428,1.313-0.428,1.857,0L39.142,15.52	C40.947,16.942,42,19.113,42,21.411V40.5C42,41.881,40.881,43,39.5,43z">
                    </path>
                </svg>
                Homepage
            </h4>
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Proposal Grade Report</a></li>
            <li><a href="#">Defense Grade Report</a></li>
            <li><a href="#">Evaluation Tracking</a></li>
        </ul>

        <h2> Pages </h2>

        <ul>
            <h4>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0,0,256,256">
                    <g fill="#ffffff" fill-rule="nonzero">
                        <g transform="scale(5.33333,5.33333)">
                            <path
                                    d="M12.5,4c-2.481,0 -4.5,2.019 -4.5,4.5v31c0,2.481 2.019,4.5 4.5,4.5h23c2.481,0 4.5,-2.019 4.5,-4.5v-19.5h-11.5c-2.481,0 -4.5,-2.019 -4.5,-4.5v-11.5zM27,4.87891v10.62109c0,0.827 0.673,1.5 1.5,1.5h10.62109zM17.5,25h13c0.828,0 1.5,0.672 1.5,1.5c0,0.828 -0.672,1.5 -1.5,1.5h-13c-0.828,0 -1.5,-0.672 -1.5,-1.5c0,-0.828 0.672,-1.5 1.5,-1.5zM17.49023,32h8.99609c0.828,0 1.5,0.671 1.5,1.5c0.001,0.759 -0.56292,1.38733 -1.29492,1.48633l-0.20312,0.01367h-8.99609c-0.828,0 -1.5,-0.672 -1.5,-1.5c0,-0.759 0.56292,-1.38733 1.29492,-1.48633z">
                            </path>
                        </g>
                    </g>
                </svg>
                Score Evaluation
            </h4>
            <li><a href="/PeriodSetting.html">Scoring Period Settings</a></li>
        </ul>

        <ul>
            <h4>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48"
                     style="fill:#FFFFFF;">
                    <path
                            d="M42 15v-2.5C42 8.916 39.084 6 35.5 6h-23C8.916 6 6 8.916 6 12.5V15H42zM25.5 27H32V33H25.5zM35 27H42V33H35zM6 27H13V33H6zM16 27H22.5V33H16zM35 18H42V24H35zM25.5 18H32V24H25.5zM25.5 36H32V42H25.5zM16 36H22.5V42H16zM35 36v6h.5c3.415 0 6.218-2.649 6.475-6H35zM6.025 36c.257 3.351 3.059 6 6.475 6H13v-6H6.025zM16 18H22.5V24H16zM6 18H13V24H6z">
                    </path>
                </svg>
                Manage Schedule
            </h4>
            <li><a href="#">Proposal Schedule</a></li>
            <li><a href="#">Defense Schedule</a></li>
        </ul>

        <ul>
            <h4>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48"
                     style="fill:#FFFFFF;">
                    <path
                            d="M35.5,8h-3.551C31.697,5.756,29.81,4,27.5,4h-7c-2.31,0-4.197,1.756-4.449,4H12.5C10.019,8,8,10.019,8,12.5v27	c0,2.481,2.019,4.5,4.5,4.5h23c2.481,0,4.5-2.019,4.5-4.5v-27C40,10.019,37.981,8,35.5,8z M20.5,7h7C28.327,7,29,7.673,29,8.5	S28.327,10,27.5,10h-7C19.673,10,19,9.327,19,8.5S19.673,7,20.5,7z M22.5,34h-8c-0.828,0-1.5-0.671-1.5-1.5s0.672-1.5,1.5-1.5h8	c0.828,0,1.5,0.671,1.5,1.5S23.328,34,22.5,34z M22.5,24h-8c-0.828,0-1.5-0.671-1.5-1.5s0.672-1.5,1.5-1.5h8	c0.828,0,1.5,0.671,1.5,1.5S23.328,24,22.5,24z M34.561,34.439c0.586,0.585,0.586,1.536,0,2.121C34.268,36.854,33.884,37,33.5,37	s-0.768-0.146-1.061-0.439L31,35.121l-1.439,1.439C29.268,36.854,28.884,37,28.5,37s-0.768-0.146-1.061-0.439	c-0.586-0.585-0.586-1.536,0-2.121L28.879,33l-1.439-1.439c-0.586-0.585-0.586-1.536,0-2.121c0.586-0.586,1.535-0.586,2.121,0	L31,30.879l1.439-1.439c0.586-0.586,1.535-0.586,2.121,0c0.586,0.585,0.586,1.536,0,2.121L33.121,33L34.561,34.439z M34.561,21.561	l-4,4C30.268,25.854,29.884,26,29.5,26s-0.768-0.146-1.061-0.439l-2-2c-0.586-0.585-0.586-1.536,0-2.121	c0.586-0.586,1.535-0.586,2.121,0l0.939,0.939l2.939-2.939c0.586-0.586,1.535-0.586,2.121,0	C35.146,20.025,35.146,20.975,34.561,21.561z">
                    </path>
                </svg>
                Manage Project
            </h4>
            <li><a href="/project-overview">Project Overview</a></li>
            <li><a href="/project-details" class="active">Project Details</a></li>
            <li><a href="/project-committee">Committee</a></li>
            <li><a href="/project-poster-committee">Poster Committee</a></li>
        </ul>
    </div>

    <div class="content">

        <div class="header-section">
            Add New Project
        </div>

        <div class="body-section">

            <div class="modal">

                <h2>Add New Project</h2>

                <div class="modal-content" id="modal-container">
                    <!--                    <h3>Project Details</h3>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Project ID :</label>-->
                    <!--                        <div class="input-icon">-->
                    <!--                            <input type="text">-->
                    <!--                            <i class="material-icons">edit</i>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Project Name :</label>-->
                    <!--                        <div class="input-icon">-->
                    <!--                            <input type="text">-->
                    <!--                            <i class="material-icons">edit</i>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Project Category :</label>-->
                    <!--                        <div class="input-icon">-->
                    <!--                            <input type="text">-->
                    <!--                            <i class="material-icons">edit</i>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Project Description :</label>-->
                    <!--                        <div class="input-icon">-->
                    <!--                            <textarea></textarea>-->
                    <!--                            <i class="material-icons">edit</i>-->
                    <!--                        </div>-->
                    <!--                    </div>-->

                    <!--                    <h3>Member Details</h3>-->
                    <!--                    <div class="form-group-row">-->
                    <!--                        <div class="form-group">-->
                    <!--                            <label>Program :</label>-->
                    <!--                            <select>-->
                    <!--                                <option>Select Program</option>-->
                    <!--                            </select>-->
                    <!--                        </div>-->
                    <!--                        <div class="form-group">-->
                    <!--                            <label>Semester :</label>-->
                    <!--                            <input type="text" value="2024" disabled>-->
                    <!--                        </div>-->
                    <!--                    </div>-->


                    <!--                    <div class="form-group">-->
                    <!--                        <label>Member :</label>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <select>-->
                    <!--                            <option>Select Student</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <select>-->
                    <!--                            <option>Select Student</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <select>-->
                    <!--                            <option>Select Student</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->

                    <!--                    <h3>Instructor Details</h3>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Advisor :</label>-->
                    <!--                        <select>-->
                    <!--                            <option>Select Advisor</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Co-Advisor :</label>-->
                    <!--                        <select>-->
                    <!--                            <option>Select Co-Advisor</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Committee :</label>-->
                    <!--                        <select>-->
                    <!--                            <option>Select Committee</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->
                    <!--                    <div class="form-group">-->
                    <!--                        <label>Committee :</label>-->
                    <!--                        <select>-->
                    <!--                            <option>Select Committee</option>-->
                    <!--                        </select>-->
                    <!--                    </div>-->

                    <!--                    <div class="button-group">-->
                    <!--                        <button class="cancel-btn">Cancel</button>-->
                    <!--                        <button class="save-btn">Save</button>-->
                    <!--                    </div>-->

                </div>
            </div>
        </div>


    </div>
</div>
</body>

</html>

<script>

    document.addEventListener("DOMContentLoaded", function () {
        // ฟังก์ชันสำหรับแสดงผลข้อมูลใน modal
        displayResults();

        // ฟังก์ชันแสดงฟอร์มที่ใช้กรอกข้อมูลโปรเจกต์ใหม่
        function displayResults() {
            // ดึงข้อมูลล่าสุดของ Project ID จาก API
            fetchLastProjectId()
                .then(lastProjectId => {
                    const modalHTML = `
                    <h3>Project Details</h3>
                    <div class="form-group">
                        <label>Project ID :</label>
                        <div class="input-icon">
                            <input type="text" id="projectId" disabled value="${generateNewProjectId(lastProjectId, 'ICT', 2024)}">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Project Name :</label>
                        <div class="input-icon">
                            <input type="text" id="projectTitle">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Project Description :</label>
                        <div class="input-icon">
                            <textarea id="projectDescription"></textarea>
                        </div>
                    </div>

                    <h3>Member Details</h3>
                    <div class="form-group-row">
                        <div class="form-group">
                            <label>Program :</label>
                            <select id="program">
                                <option value="ICT">ICT</option>
                                <option value="DST">DST</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Semester :</label>
                            <input type="text" value="2024" disabled>
                        </div>
                    </div>

                    <!-- ดึงข้อมูลนักศึกษาที่ยังไม่มีโปรเจกต์และแสดงใน dropdown -->
                    <div class="form-group">
                        <label>Select Student 1:</label>
                        <select id="studentSelect1">
                            <option value="">Select Student</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Select Student 2:</label>
                        <select id="studentSelect2">
                            <option value="">Select Student</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Select Student 3:</label>
                        <select id="studentSelect3">
                            <option value="">Select Student</option>
                        </select>
                    </div>

                  <h3>Instructor Details</h3>
                    <div class="form-group">
                        <label>Advisor:</label>
                        <select id="advisorSelect">
                            <option value="">Select Advisor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Co-Advisor:</label>
                        <select id="coAdvisorSelect">
                            <option value="">Select Co-Advisor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Committee:</label>
                        <select id="committeeSelect">
                            <option value="">Select Committee</option>
                        </select>
                    </div>


                    <div class="button-group">
                        <button class="cancel-btn">Cancel</button>
                        <button class="save-btn">Save</button>
                    </div>
                `;

                    // แสดงผล Modal ที่ div ที่ต้องการ
                    document.getElementById('modal-container').innerHTML = modalHTML;

                    // ดึงข้อมูลนักศึกษาที่ไม่มีโปรเจกต์และแสดงใน dropdown
                    fetchStudentsWithoutProject();

                    // คลิกปุ่ม Cancel
                    document.querySelector('.cancel-btn').addEventListener('click', function () {
                        window.location.href = "http://localhost:8080/project-details";  // เปลี่ยนเส้นทางไปหน้าอื่นเมื่อกดยกเลิก
                    });

                    // คลิกปุ่ม Save
                    document.querySelector('.save-btn').addEventListener('click', function () {
                        saveProjectData();  // เรียกฟังก์ชันบันทึกข้อมูล
                    });
                })
                .catch(error => {
                    console.error("Error fetching last project ID:", error);
                });
        }

        // -------------------- Project -------------------- //
        // ฟังก์ชันสำหรับการสร้าง Project ID ใหม่โดยอัตโนมัติ
        function generateNewProjectId(lastProjectId, program, year) {
            const prefix = program;  // ค่า program (DST, ICT)
            const yearPart = year.toString();  // ใช้ปีแบบเต็ม เช่น 2024
            let sequencePart = "01";  // ค่าเริ่มต้นลำดับ

            if (lastProjectId && lastProjectId.startsWith(prefix) && lastProjectId.includes("SP")) {
                const lastSequence = lastProjectId.substring(lastProjectId.length - 2);  // รับลำดับสุดท้ายจากรหัสโปรเจกต์
                const newSequence = parseInt(lastSequence) + 1;
                sequencePart = newSequence.toString().padStart(2, "0");  // เพิ่มลำดับใหม่และจัดรูปแบบให้เป็น 2 หลัก
            }

            return `SP${yearPart}-${sequencePart}`;
        }

        // ฟังก์ชันดึงข้อมูล Project ID ล่าสุดจาก API
        function fetchLastProjectId() {
            return fetch('http://localhost:8080/admin/getLastProjectId')
                .then(response => response.json())  // รับข้อมูล JSON
                .then(data => {
                    return data.lastProjectId;  // คืนค่ารหัสโปรเจกต์ล่าสุด
                })
                .catch(error => {
                    console.error("Error fetching last project ID:", error);
                    return null;  // ถ้าไม่สามารถดึงข้อมูลได้ ให้ส่งคืน null
                });
        }

        // -------------------- Student -------------------- //
        let studentsWithoutProject = []; // สมมติว่ามีข้อมูลนักศึกษาที่ไม่ได้มีโปรเจกต์แล้วจาก API

        // ฟังก์ชันดึงข้อมูลนักศึกษาที่ยังไม่มีโปรเจกต์
        function fetchStudentsWithoutProject() {
            fetch("http://localhost:8080/admin/getStudentsWithoutProject") // ดึงข้อมูลจาก API
                .then(response => response.json())
                .then(data => {
                    studentsWithoutProject = data; // เก็บข้อมูลนักศึกษาที่ไม่มีโปรเจกต์
                    populateDropdowns(); // เพิ่มข้อมูลนักศึกษาเข้า dropdown
                })
                .catch(error => console.error("Error fetching students:", error));
        }

        // ฟังก์ชันสำหรับเพิ่มข้อมูลนักศึกษาเข้า dropdown
        function populateDropdowns() {
            const studentSelect1 = document.getElementById("studentSelect1");
            const studentSelect2 = document.getElementById("studentSelect2");
            const studentSelect3 = document.getElementById("studentSelect3");

            const allDropdowns = [studentSelect1, studentSelect2, studentSelect3];

            // ฟังก์ชันที่ใช้กรองนักศึกษาในแต่ละ dropdown
            function filterStudents(selectedStudents) {
                return studentsWithoutProject.filter(student => !selectedStudents.includes(student.studentId));
            }

            // ฟังก์ชันสำหรับกรอก dropdown
            function populateDropdown(dropdown, selectedStudents) {
                dropdown.innerHTML = "<option value=''>Select Student</option>"; // reset options
                const availableStudents = filterStudents(selectedStudents);

                availableStudents.forEach(student => {
                    const option = document.createElement("option");
                    option.value = student.studentId;
                    option.textContent = `${student.studentId} - ${student.studentName}`;
                    dropdown.appendChild(option);
                });
            }

            // สร้างตัวแปรเก็บข้อมูลนักศึกษาที่ถูกเลือกใน dropdowns
            let selectedStudents = [];

            // เริ่มต้นการกรอก dropdown ทั้ง 3 ด้วยข้อมูลนักศึกษาที่ไม่มีโปรเจกต์
            allDropdowns.forEach(d => populateDropdown(d, selectedStudents));
        }

        // เรียกฟังก์ชันเพื่อดึงข้อมูลนักศึกษาที่ไม่มีโปรเจกต์
        fetchStudentsWithoutProject();

        // -------------------- Instructor -------------------- //
        let instructors = [];

        // ฟังก์ชันดึงข้อมูลอาจารย์จาก API
        function fetchInstructors() {
            fetch('http://localhost:8080/admin/getInstructors')  // URL ที่ดึงข้อมูลจาก API
                .then(response => response.json())
                .then(data => {
                    instructors = data;  // เก็บข้อมูลอาจารย์
                    populateInstructorDropdown();  // แสดงใน dropdown
                })
                .catch(error => console.error("Error fetching instructors:", error));
        }

        // ฟังก์ชันแปลง `professorId` เป็น `professorName` และแสดงใน dropdown
        function populateInstructorDropdown() {
            const advisorSelect = document.getElementById('advisorSelect');
            const coAdvisorSelect = document.getElementById('coAdvisorSelect');
            const committeeSelect = document.getElementById('committeeSelect');

            // ฟังก์ชันเพื่อเพิ่มข้อมูลใน dropdown
            function populateDropdown(dropdown, selectedInstructors = []) {
                dropdown.innerHTML = "<option value=''>Select</option>";  // reset options

                instructors.forEach(instructor => {
                    if (!selectedInstructors.includes(instructor.professorId)) {
                        const option = document.createElement('option');
                        option.value = instructor.professorId;  // ใช้ professorId สำหรับ value
                        option.textContent = instructor.professorName;  // แสดง professorName ใน dropdown
                        dropdown.appendChild(option);
                    }
                });
            }

            // เริ่มต้นกรอก dropdown ด้วยข้อมูลอาจารย์
            populateDropdown(advisorSelect);
            populateDropdown(coAdvisorSelect);
            populateDropdown(committeeSelect);
        }

        // เรียกใช้ฟังก์ชันเพื่อดึงข้อมูลอาจารย์จาก API
        fetchInstructors();


        // -------------------- Save Project and Send to DB -------------------- //
        // ฟังก์ชันบันทึกข้อมูลโปรเจกต์ใหม่
        function saveProjectData() {
            // เก็บข้อมูลที่กรอก
            const projectTitle = document.getElementById('projectTitle').value;
            const projectDescription = document.getElementById('projectDescription').value;
            const program = document.getElementById('program').value;

            // ดึงค่าจาก dropdown ของนักศึกษา
            const student1Value = document.getElementById('studentSelect1') ? document.getElementById('studentSelect1').value : null;
            const student2Value = document.getElementById('studentSelect2') ? document.getElementById('studentSelect2').value : null;
            const student3Value = document.getElementById('studentSelect3') ? document.getElementById('studentSelect3').value : null;

            // ดึงค่าจาก dropdown Instructor
            const advisor = document.getElementById('advisorSelect').value;
            const coAdvisor = document.getElementById('coAdvisorSelect').value;
            const committee = document.getElementById('committeeSelect').value;

            // ตรวจสอบว่าเลือก student หรือไม่
            if (!student1Value && !student2Value && !student3Value) {
                alert('Please select at least one student!');
                return;  // หยุดการดำเนินการ
            }

            // หากไม่มีค่า Advisor ให้แจ้งเตือน
            if (!advisor) {
                alert('Please select an advisor!');
                return;  // หยุดการดำเนินการ
            }

            // สร้าง list ของ studentId ที่ถูกเลือก
            const selectedStudentIds = [student1Value, student2Value, student3Value].filter(studentId => studentId);

            // ฟังก์ชันสำหรับดึงข้อมูลนักศึกษาจาก studentId
            function getStudentDetails(studentId) {
                // ใช้ฟังก์ชันหรือติดต่อ API เพื่อดึงข้อมูลของนักศึกษาจาก studentId
                // ตัวอย่างนี้คือดึงจาก studentsWithoutProject ที่เก็บข้อมูลนักศึกษาทั้งหมด
                const student = studentsWithoutProject.find(s => s.studentId === studentId);
                return student ? {studentId: student.studentId, studentName: student.studentName} : null;
            }

            // เก็บข้อมูลนักศึกษาที่จะส่งไปใน request
            const studentList = selectedStudentIds.map(studentId => getStudentDetails(studentId));

            let professorList = [];

            if (advisor) {
                const advisorName = instructors.find(instructor => instructor.professorId === advisor).professorName;
                professorList.push({ professorName: advisorName, role: 'Advisor' });
            }

            if (coAdvisor) {
                const coAdvisorName = instructors.find(instructor => instructor.professorId === coAdvisor).professorName;
                professorList.push({ professorName: coAdvisorName, role: 'Co-Advisor' });
            }

            if (committee) {
                const committeeName = instructors.find(instructor => instructor.professorId === committee).professorName;
                professorList.push({ professorName: committeeName, role: 'Committee' });
            }

            // เก็บข้อมูลที่ต้องส่งไปยัง Controller
            const newProjectDetails = {
                projectTitle,  // ค่า projectTitle
                projectDescription,  // ค่า projectDescription
                program,  // ค่า program
                studentList,  // รายชื่อสมาชิกที่เก็บทั้ง studentId และ studentName
                professorList
            };



            // ตรวจสอบข้อมูลที่ต้องส่งไปยังเซิร์ฟเวอร์
            console.log("Sending data to the server: ", newProjectDetails);

            // ส่งข้อมูลไปที่ Controller
            fetch("http://localhost:8080/admin/addNewProject", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(newProjectDetails)
            })
                .then(response => response.json())
                .then(data => {
                    console.log("Success:", data);
                    showNotification("New project added successfully!");
                })
                .catch(error => {
                    console.error("Error:", error);
                    showNotification("Error adding new project: " + error.message);
                });
        }

        // ฟังก์ชัน showNotification สำหรับการแสดงแจ้งเตือน
        function showNotification(message, callback) {
            const notification = document.createElement("div");
            notification.textContent = message;
            notification.style.position = "fixed";
            notification.style.top = "20px";
            notification.style.right = "20px";
            notification.style.padding = "10px 20px";
            notification.style.background = "green";
            notification.style.color = "white";
            notification.style.borderRadius = "5px";
            notification.style.boxShadow = "0 0 10px rgba(0,0,0,0.3)";
            document.body.appendChild(notification);

            // ให้ข้อความหายไปอัตโนมัติหลังจาก 1 วินาที
            setTimeout(() => {
                notification.remove();
                if (callback) callback(); // เรียก callback หลังจากแจ้งเตือนเสร็จ
            }, 1000);
        }

        document.addEventListener("DOMContentLoaded", function () {
            const projectId = generateNewProjectId();
            fetchInstructorsWithoutProject(projectId);
        });
    });

</script>