<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> Edit Proposal Schedule</title>

  <!-- CSS -->
  <link rel="stylesheet" href="/CSS/sidebar-admin.css">
  <link rel="stylesheet" href="/CSS/EditScheduleTiming.css">

  <!-- Library -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
<div class="container">
  <!-- Slide bar-->
  <div class="sidebar">
    <h2>ICT MAHIDOL</h2>

    <form th:action="@{/logout}" method="post" class="logout-container">
      <!--        ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Cross-Site Request Forgery (CSRF)-->
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
      <button type="submit" class="logout-button"><i class="fas fa-sign-out-alt"></i></button>
    </form>

    <ul>
      <h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48" style="fill:#FFFFFF;">
        <path
                d="M39.5,43h-9c-1.381,0-2.5-1.119-2.5-2.5v-9c0-1.105-0.895-2-2-2h-4c-1.105,0-2,0.895-2,2v9c0,1.381-1.119,2.5-2.5,2.5h-9	C7.119,43,6,41.881,6,40.5V21.413c0-2.299,1.054-4.471,2.859-5.893L23.071,4.321c0.545-0.428,1.313-0.428,1.857,0L39.142,15.52	C40.947,16.942,42,19.113,42,21.411V40.5C42,41.881,40.881,43,39.5,43z">
        </path>
      </svg> Homepage </h4>
      <li><a href="/admin-dashboard">Dashboard</a></li>
      <li><a href="/admin-proposal-report">Proposal Grade Report</a></li>
      <li><a href="/admin-defense-report">Defense Grade Report</a></li>
      <li><a href="/admin-eva-traking">Evaluation Tracking</a></li>
      <li><a href="/admin-timeliness-scoring">Timeliness Scoring</a></li>
    </ul>

    <h2> Pages </h2>

    <ul>
      <h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0,0,256,256">
        <g fill="#ffffff" fill-rule="nonzero">
          <g transform="scale(5.33333,5.33333)">
            <path
                    d="M12.5,4c-2.481,0 -4.5,2.019 -4.5,4.5v31c0,2.481 2.019,4.5 4.5,4.5h23c2.481,0 4.5,-2.019 4.5,-4.5v-19.5h-11.5c-2.481,0 -4.5,-2.019 -4.5,-4.5v-11.5zM27,4.87891v10.62109c0,0.827 0.673,1.5 1.5,1.5h10.62109zM17.5,25h13c0.828,0 1.5,0.672 1.5,1.5c0,0.828 -0.672,1.5 -1.5,1.5h-13c-0.828,0 -1.5,-0.672 -1.5,-1.5c0,-0.828 0.672,-1.5 1.5,-1.5zM17.49023,32h8.99609c0.828,0 1.5,0.671 1.5,1.5c0.001,0.759 -0.56292,1.38733 -1.29492,1.48633l-0.20312,0.01367h-8.99609c-0.828,0 -1.5,-0.672 -1.5,-1.5c0,-0.759 0.56292,-1.38733 1.29492,-1.48633z">
            </path>
          </g>
        </g>
      </svg>Score Evaluation </h4>
      <li><a href="/scoring-periods">Scoring Period Settings</a></li>
    </ul>

    <ul>
      <h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48" style="fill:#FFFFFF;">
        <path
                d="M42 15v-2.5C42 8.916 39.084 6 35.5 6h-23C8.916 6 6 8.916 6 12.5V15H42zM25.5 27H32V33H25.5zM35 27H42V33H35zM6 27H13V33H6zM16 27H22.5V33H16zM35 18H42V24H35zM25.5 18H32V24H25.5zM25.5 36H32V42H25.5zM16 36H22.5V42H16zM35 36v6h.5c3.415 0 6.218-2.649 6.475-6H35zM6.025 36c.257 3.351 3.059 6 6.475 6H13v-6H6.025zM16 18H22.5V24H16zM6 18H13V24H6z">
        </path>
      </svg> Manage Schedule </h4>
      <li><a href="/admin/proposalSchedule">Proposal Schedule</a></li>
      <li><a href="/admin/editProposalSchedulePage" class="active" >Edit Proposal Timing</a></li>
      <li><a href="/admin/defenseSchedule">Defense Schedule</a></li>
      <li><a href="/admin/editDefenseSchedulePage">Edit Defense Timing</a></li>
    </ul>

    <ul>
      <h4><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48" style="fill:#FFFFFF;">
        <path
                d="M35.5,8h-3.551C31.697,5.756,29.81,4,27.5,4h-7c-2.31,0-4.197,1.756-4.449,4H12.5C10.019,8,8,10.019,8,12.5v27	c0,2.481,2.019,4.5,4.5,4.5h23c2.481,0,4.5-2.019,4.5-4.5v-27C40,10.019,37.981,8,35.5,8z M20.5,7h7C28.327,7,29,7.673,29,8.5	S28.327,10,27.5,10h-7C19.673,10,19,9.327,19,8.5S19.673,7,20.5,7z M22.5,34h-8c-0.828,0-1.5-0.671-1.5-1.5s0.672-1.5,1.5-1.5h8	c0.828,0,1.5,0.671,1.5,1.5S23.328,34,22.5,34z M22.5,24h-8c-0.828,0-1.5-0.671-1.5-1.5s0.672-1.5,1.5-1.5h8	c0.828,0,1.5,0.671,1.5,1.5S23.328,24,22.5,24z M34.561,34.439c0.586,0.585,0.586,1.536,0,2.121C34.268,36.854,33.884,37,33.5,37	s-0.768-0.146-1.061-0.439L31,35.121l-1.439,1.439C29.268,36.854,28.884,37,28.5,37s-0.768-0.146-1.061-0.439	c-0.586-0.585-0.586-1.536,0-2.121L28.879,33l-1.439-1.439c-0.586-0.585-0.586-1.536,0-2.121c0.586-0.586,1.535-0.586,2.121,0	L31,30.879l1.439-1.439c0.586-0.586,1.535-0.586,2.121,0c0.586,0.585,0.586,1.536,0,2.121L33.121,33L34.561,34.439z M34.561,21.561	l-4,4C30.268,25.854,29.884,26,29.5,26s-0.768-0.146-1.061-0.439l-2-2c-0.586-0.585-0.586-1.536,0-2.121	c0.586-0.586,1.535-0.586,2.121,0l0.939,0.939l2.939-2.939c0.586-0.586,1.535-0.586,2.121,0	C35.146,20.025,35.146,20.975,34.561,21.561z">
        </path>
      </svg> Manage Project </h4>
      <li><a href="/project-overview">Project Overview</a></li>
      <li><a href="/project-details">Project Details</a></li>
      <li><a href="/project-committee">Committee</a></li>
      <li><a href="/project-poster-committee">Poster Committee</a></li>
    </ul>
  </div>


  <div class="content">

    <div class="header-section">
      Edit Proposal Timing
      <input type="hidden" id="csrfToken" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

      <!--      <div class="btn-header">-->
      <!--        <button class="template-btn">Template</button>-->
      <!--        <button class="upload-btn">Upload Files</button>-->
      <!--        <button class="addProject-btn">+ Add Projects</button>-->
      <!--      </div>-->
      <div class="semester-container">
        <select id="semester-selector" onchange="getProjectEditProposal();"></select>
      </div>

    </div>

    <div class="body-section">

      <div class="table-container">
        <div class="filter-controls">
          <button class="filter active" onclick="filterProjects('all')">All</button>
          <button class="filter" onclick="filterProjects('ict')">ICT</button>
          <button class="filter" onclick="filterProjects('dst')">DST</button>
          <input type="text" id="searchInput" placeholder="Search">

        </div>
        <table>
          <thead>
          <tr>
            <th class="left-align">Project ID</th>
            <th class="left-align">Project Title</th>
            <th class="left-align">Instructor</th>
            <th>Date</th>
            <th>Time</th>
            <th>Room</th>
            <th>Actions</th>
          </tr>
          </thead>
          <tbody id="projectTable">

          <!--          <tr data-category="ict">-->
          <!--            <td><span class="tag ict">ICT</span> SP2024-01 </td>-->
          <!--            <td>A Noise-Resilient Model</td>-->
          <!--            <td>-->
          <!--              <div class="instructor-container">-->
          <!--                <div class="instructor-group">-->
          <!--                  <div>-->
          <!--                    <span class="advisor-label">Advisor</span>-->
          <!--                    <span class="instructor-name">Aj.Akara</span>-->
          <!--                  </div>-->
          <!--                </div>-->
          <!--                <div class="instructor-group">-->
          <!--                  <div class="instructor-name">Aj.XXX, Aj.YYY</div>-->
          <!--                  <div class="instructor-type">Co-Instructor</div>-->
          <!--                </div>-->
          <!--              </div>-->
          <!--            </td>-->
          <!--            <td>2025-03-06</td>-->
          <!--            <td>13:00 - 14:00</td>-->
          <!--            <td>IT103</td>-->
          <!--            <td>-->
          <!--              <button class="edit-btn" onclick="showProjectDetails('project1')">Edit</button>-->
          <!--            </td>-->
          <!--          </tr>-->

          <!--          <tr data-category="dst">-->
          <!--            <td><span class="tag dst">DST</span> SP2024-02 </td>-->
          <!--            <td>IoT Dashboard</td>-->
          <!--            <td>-->
          <!--              <div class="instructor-container">-->
          <!--                <div class="instructor-group">-->
          <!--                  <div>-->
          <!--                    <span class="advisor-label">Advisor</span>-->
          <!--                    <span class="instructor-name">Aj.Akara</span>-->
          <!--                  </div>-->
          <!--                </div>-->
          <!--                  <div class="instructor-name">Aj.Sudsanguan, Aj.Thanaporn</div>-->
          <!--                  <div class="instructor-type">Co-Instructor</div>-->
          <!--                </div>-->
          <!--              </div>-->
          <!--            </td>-->
          <!--            <td>2025-03-013</td>-->
          <!--              <td>13:00 - 14:00</td>-->
          <!--              <td>IT202</td>-->
          <!--            <td>-->
          <!--              <button class="edit-btn" onclick="showProjectDetails('project1')">Edit</button>-->
          <!--            </td>-->
          <!--          </tr>-->

          </tbody>
        </table>
      </div>
    </div>

    <div id="overlay"></div>
    <div class="card-popup">
      <!--        <p>CSRF Token: <span th:text="${_csrf.token}">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤</span></p>-->
      <!--            <div class="card-header">-->
      <!--                <h1 class="card-title">DST SP2024-04</h1>-->
      <!--                <div class="tag ict">ICT</div>-->
      <!--            </div>-->

      <!--            <div class="project-info">-->
      <!--                <p><strong>Project Title : </strong> Project Management Tools (ProjectESS)</p>-->
      <!--            </div>-->

      <!--            <div class="students-section">-->
      <!--                <h2 class="section-title">Instructor</h2>-->

      <!--                <div class="student-card">-->
      <!--                    <div class="student-name">Tunyarat Nithirunpattana</div>-->
      <!--                    <div class="student-details">Advisor</div>-->
      <!--                </div>-->

      <!--                <div class="student-card">-->
      <!--                    <div class="student-name">Chanyanuch Nuangjumnong</div>-->
      <!--                    <div class="student-details">Committee</div>-->
      <!--                </div>-->

      <!--                <div class="student-card">-->
      <!--                    <div class="student-name">Neadnapa Thawontaweekul</div>-->
      <!--                    <div class="student-details">Committee</div>-->
      <!--                </div>-->
      <!--            </div>-->

      <!--        <div class="modal-body">-->
      <!--            <input type="hidden" id="csrfToken" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />-->
      <!--                        <p>CSRF Token: <span th:text="${_csrf.token}">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤</span></p>-->
      <!--            <label>Start Date:</label>-->
      <!--            <input type="date" class="custom-input" id="start-date"/><br>-->

      <!--            <label>End Date:</label>-->
      <!--            <input type="date" class="custom-input" id="end-date"/><br>-->

      <!--            <label>Time Start :</label>-->
      <!--            <input type="time" class="custom-input"><br>-->

      <!--            <label>End Start :</label>-->
      <!--            <input type="time" class="custom-input"><br>-->

      <!--            <label>Room: </label>-->
      <!--            <div class="dropdown">-->

      <!--                <button id="selected-label" onclick="toggleDropdown()">-->
      <!--                    <span id="selected-text">Select Room</span>-->
      <!--                </button>-->

      <!--                <div class="dropdown-content upward" id="dropdown-content">-->
      <!--                    <input type="text" id="search" placeholder="Search" onkeyup="filterRooms()">-->
      <!--                    <div id="room-list"></div>-->
      <!--                </div>-->
      <!--            </div>-->
      <!--        </div>-->

      <!--            <div class="modal-footer">-->
      <!--                <button id="saveBtn">Save</button>-->
      <!--                <button id="cancelBtn">Cancel</button>-->
      <!--            </div>-->

    </div>

    <!--          https://codepen.io/AdamDipinto/pen/ewKxwE-->
    <div class="modal-loader-overlay" id="modalLoaderOverlay" style="display:none;">
      <div class="loader-center">
        <div class="loader">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>


  </div>
</div>
</body>

</html>

<script>

  document.addEventListener("DOMContentLoaded", function () {
    const menuItems = document.querySelectorAll(".sidebar ul li a");

    // ‡∏î‡∏∂‡∏á URL ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    const currentPage = window.location.pathname.split("/").pop();

    menuItems.forEach(item => {
      if (item.getAttribute("href") === currentPage) {
        item.classList.add("active"); // ‡πÄ‡∏û‡∏¥‡πà‡∏° class "active" ‡πÉ‡∏´‡πâ‡πÄ‡∏°‡∏ô‡∏π‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      }
    });
  });

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
  function filterProjects(category) {
    const tbody = document.getElementById("projectTable");
    const rows = tbody.querySelectorAll("tr:not(#noDataRow)");

    let found = false;

    const noDataRow = document.getElementById("noDataRow");
    if(noDataRow) {
      noDataRow.remove();
    }

    rows.forEach(row => {

      if(category === "all" || row.getAttribute("data-category") === category) {
        row.style.display = "";
        found = true;
      } else {
        row.style.display = "none";
      }
      // row.style.display = row.getAttribute("data-category") === category ? "" : "none";
      //
      // if(noDataRow) {
      //   noDataRow.remove();
      // }

    });

    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö category
    if(!found) {

      const row = document.createElement("tr");
      row.id = "noDataRow";

      const cell = document.createElement("td");
      cell.innerHTML = "No data available";
      cell.colSpan = 8;
      cell.style.textAlign = "center";
      cell.style.color = "#e23855";

      row.appendChild(cell);
      tbody.appendChild(row);
    }

    document.querySelectorAll(".filter").forEach(btn => btn.classList.remove("active"));
    document.querySelector(`.filter[onclick="filterProjects('${category}')"]`).classList.add("active");
  }

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå
  function searchProjects() {
    const searchValue = document.getElementById("searchInput").value.toLowerCase();
    const rows = document.querySelectorAll("#projectTable tr");

    rows.forEach(row => {
      const text = row.innerText.toLowerCase();
      row.style.display = text.includes(searchValue) ? "" : "none";
    });
  }

  document.getElementById("searchInput").addEventListener("input", searchProjects);

  // ============================================================= Get all project edit =====================================================================

  function getProjectEditProposal() {
    document.getElementById("modalLoaderOverlay").style.display = "flex";

    const semesterYear = document.getElementById("semester-selector").value;

    fetch(`http://localhost:8080/admin/getProjectEditProposal?semesterYear=${encodeURIComponent(semesterYear)}`, {

      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
      },
    })
            .then(response => {
              if (!response.ok) {
                document.getElementById("modalLoaderOverlay").style.display = "none";

                const tbody = document.getElementById("projectTable");
                tbody.innerHTML = ""
                return;

                throw new Error('Network response was not ok ' + response.statusText);
                alert('Network response was not ok ' + response.statusText);
              }
              return response.json();
            })
            .then(data => {
              console.log("üêçdata: ", data);
              const tbody = document.getElementById("projectTable");
              tbody.innerHTML = ""

              if(data.length === 0) {
                console.log("No data available");

                // const tbody = document.getElementById("projectTable");
                const row = document.createElement("tr");

                const cell = document.createElement("td");

                cell.innerHTML = "No data available";
                cell.colSpan = 8;
                cell.style.textAlign = "center";
                cell.style.color = "#e23855";

                row.style.marginTop = "1rem";

                row.appendChild(cell);
                tbody.appendChild(row);
                document.getElementById("modalLoaderOverlay").style.display = "none";

              } else {
                // console.log("Data found: ", data);

                const tbody = document.getElementById("projectTable");

                data.sort((a, b) => {

                  //Note: https://docs.pexip.com/admin/regex_reference.htm
                  // \d Matches a decimal digit character (i.e. 0-9).
                  // + Matches 1 or more repetitions of the previous character or expression.
                  // $ 	Matches the end of the line
                  let idA = parseInt(a.projectId.match(/\d+$/));
                  let idB = parseInt(b.projectId.match(/\d+$/));

                  return idA - idB

                })

                data.forEach(project => {

                  const row = document.createElement("tr");
                  row.setAttribute("data-category", project.program.toLowerCase());

                  let advisor = "";
                  let committee = "";

                  if(typeof project.instructorNames === "object") {

                    advisor = project.instructorNames.Advisor ? {name: project.instructorNames.Advisor[0]}: null;
                    committee = project.instructorNames.Committee || [];
                  }

                  let projectId = project.projectId;
                  let cleanId = projectId.replace(/DST|ICT/g, '').trim();

                  let timeSlot = "";
                  let FormattedDate = "";
                  if (project.startTime && project.endTime != null) {
                    // JavaScript Date object
                    const startTime = new Date(project.startTime);
                    const endTime = new Date(project.endTime);
                    timeSlot = `${String(startTime.getHours()).padStart(2, '0')}:${String(startTime.getMinutes()).padStart(2, '0')} - ${String(endTime.getHours()).padStart(2, '0')}:${String(endTime.getMinutes()).padStart(2, '0')}`;
                    console.log("üï∞Ô∏è timeSlot: ", timeSlot);
                    console.log("startTime: ", startTime);
                    console.log("endTime: ", endTime);

                    const getDate = new Date(project.date);
                    let nameDay = getDate.toLocaleDateString('en-us', {weekday: 'short'})
                    let month = getDate.toLocaleDateString('en-us', {month: 'short'})
                    let date = getDate.toLocaleDateString('en-us', {day: 'numeric'})
                    let year = getDate.toLocaleDateString('en-us', {year: 'numeric'})

                    // FormattedDate = `${nameDay} ${month} ${date}, ${year}`
                    FormattedDate = `${nameDay}, ${date} ${month}. ${year}`
                    console.log("üóìÔ∏è getDate: ", getDate);
                    console.log("FormattedDate: ", FormattedDate);
                  }


                  row.innerHTML = `
                    <td class="left-align">${cleanId} <br><span class="tag ${project.program.toLowerCase()}">${project.program}</span></td>
                    <td class="left-align">${project.projectTitle}</td>
                    <td>
                      <div class="instructor-container">
                      ${advisor
                          ?`
                            <div class="instructor-group">
                              <div>
                                <span class="advisor-label">Advisor</span>
                                <span class="instructor-name">${advisor.name}</span>
                              </div>
                            </div>

                            `
                          : ''}

                        ${committee.length > 0
                          ?`
                            <div class="instructor-group">
                                <div class="instructor-name">${committee.join(", ")}</div>
                                <div class="instructor-type">Committee</div>
                              </div>
                            </div>
                       `
                          : ''}
                    </td>
                    <td class="${!FormattedDate? 'empty-date' : ''}">${FormattedDate ? FormattedDate: ''}</td>
                    <td class="${!timeSlot ? 'empty-time' : ''}">${timeSlot ? timeSlot: ''}</td>
                    <td class="${!project.room ? 'empty-room' : ''}">${project.room ? project.room: ''}</td>
                    <td>
                      <button class="edit-btn" data-id="${projectId}">Edit</button>
                    </td>
                  `;
                  tbody.appendChild(row);
                  document.getElementById("modalLoaderOverlay").style.display = "none";
                });

              }
            })
            .catch(error => {
              console.error('Error fetching data:', error);
              document.getElementById("modalLoaderOverlay").style.display = "none";

              Swal.fire({
                icon: "error",
                title: "Oops...",
                text: "Something went wrong!",
              });
            });
  }


  // ============================================================= Modal =====================================================================


  document.addEventListener('DOMContentLoaded', function () {

    document.querySelector('tbody').addEventListener('click', function (e) {

      if(e.target.classList.contains("edit-btn")) {

        const projectId = e.target.getAttribute("data-id");
        console.log("üìå Open modal");

        getProjectEditProposalByProjectId(projectId)

        document.querySelector(".card-popup").style.display = "block";
        document.getElementById('overlay').style.display = 'block';

      }
    });

    document.querySelector('.card-popup').addEventListener("click", function (e) {
      if(e.target.id === ("cancelBtn") ){
        document.querySelector(".card-popup").style.display = "none";
        document.getElementById('overlay').style.display = 'none';

      }
    });

  });


  document.addEventListener("DOMContentLoaded", function() {

    window.onclick = function(event) {
      const modal = document.querySelector(".card-popup");

      if (modal && !modal.contains(event.target) && !event.target.classList.contains("edit-btn") && !document.querySelector(".swal2-container") && !event.target.closest(".floor-item")) {
        console.log("‚õî ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å Modal -> ‡∏õ‡∏¥‡∏î Modal");
        document.querySelector(".card-popup").style.display = "none";
        document.getElementById('overlay').style.display = 'none';
      }

    };
  });

  document.addEventListener('DOMContentLoaded', async function () {
    console.log("üöÄ Load Page");
    await getProjectEditProposal();
    await fetchAcademicYears();
  });

  function fetchData() {
    let url = 'http://localhost:8080/admin/roomFloorSetting';

    fetch(url)
            .then(response => {
              // console.log(response.json());
              if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
              }
              return response.json();
            })
            .then(data => {
              console.log("üêç Data Length: " + data.length);
              console.log("Show Data: " + JSON.stringify(data, null, 2));

              rooms.length = 0;

              for(const key in data) {

                rooms.push({
                  name: key,
                  floor: data[key]
                });

              }

              // console.log("üêç rooms: " + rooms);

              // https://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_localecompare2
              rooms.sort((a, b) => {

                if(a.floor !== b.floor) {

                  return a.floor.localeCompare(b.floor);
                }

                return a.name.localeCompare(b.name);

              });

              // rooms.forEach(room => {
              //   console.log("Room: " + room.name + ", Floor: " + room.floor);
              // })

              const dropdown = document.getElementById("dropdown-content");
              if (dropdown.style.display === "block") {

                showFloors();

              }

            })
            .catch(error => {
              console.error('Error fetching data:', error);
              document.getElementById('filter-results').innerHTML = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á";
            });
  }

  // room
  const rooms = [];
  let selectedRoom = ""
  let selectedFloor = null;

  function getFloors() {

    const flors = new Set();
    rooms.forEach(room => flors.add(room.floor));

    return Array.from(flors).sort();
  }

  function showFloors() {

    let roomList = document.getElementById("room-list");
    roomList.innerHTML = "";

    // set
    document.getElementById("search-container").style.display = "none";
    document.getElementById("back-button").style.display = "none";
    document.getElementById("floor-title").textContent = "Select Floor";

    const floors = getFloors();

    console.log("üè¢ ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏±‡πâ‡∏ô:", floors);

    floors.forEach(floor => {

      let floorItem = document.createElement("div");
      floorItem.classList.add("floor-item");
      floorItem.textContent = `Floor ${floor}`;

      // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤ room ‡πÉ‡∏ô‡πÄ‡πÄ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô
      const selectedInFloor = rooms.filter(r => r.name === selectedRoom && r.floor === floor);

      if(selectedInFloor.length > 0) {

        let countBadge = document.createElement("span");

        countBadge.classList.add("count-badge");
        // ‡∏ô‡∏±‡∏ö‡∏à‡∏ô.
        countBadge.textContent = selectedInFloor.length;
        floorItem.appendChild(countBadge);

      }

      floorItem.onclick = function () {

        selectedFloor = floor;
        showRoomsByFloor(floor);

      };

      roomList.appendChild(floorItem);

    });

  }

  // ‡∏Å‡∏£‡∏≠‡∏á room ‡πÄ‡πÄ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ create
  function showRoomsByFloor(floor) {

    let roomList = document.getElementById("room-list");
    roomList.innerHTML = "";

    document.getElementById("search-container").style.display = "block";
    document.getElementById("back-button").style.display = "flex";
    document.getElementById("floor-title").textContent = `Floor ${floor}`;
    document.getElementById("dropdown-content").style.display = "block";

    console.log(`üè¢ ‡πÅ‡∏™‡∏î‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô ${floor}`);

    const roomsInFloor = rooms.filter(room => room.floor === floor)
            .map(room => room.name);

    createRooms(roomsInFloor);

  }

  function filterRooms() {

    console.log("Floor:", selectedFloor)

    if(!selectedFloor) return;

    // change
    let searchValue = document.getElementById("search").value.toLowerCase();
    console.log(`üîé Find: ${searchValue}`);

    let filteredRooms = rooms.filter(room => room.name.toLowerCase().includes(searchValue) && room.floor === selectedFloor)
            .map(room => room.name);
    console.log("üìã Result:", filteredRooms);

    createRooms(filteredRooms); // ‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
  }


  function createRooms(roomNames = []) {

    let roomList = document.getElementById("room-list");
    let selectedText = document.getElementById("selected-text");
    roomList.innerHTML = ""; // clear

    console.log("üîÑ Load new room");
    console.log("üîç Room:", roomNames);

    if (roomNames.length === 0) {

      let noResult = document.createElement("div");
      noResult.textContent = "Room not found.";
      noResult.style.color = "#888";
      noResult.style.padding = "1rem";
      roomList.appendChild(noResult);

      return;
    }

    roomNames.forEach(room => {
      let label = document.createElement("label");
      label.classList.add("room-label");
      let radio = document.createElement("input");

      radio.type = "radio";
      radio.value = room;
      radio.name = "room";
      radio.checked = room === selectedRoom;

      radio.onchange = function () {
        if (radio.checked) {
          selectedRoom = room;
          selectedText.textContent = room;
          console.log(`‚úÖ Select room: ${room}`);
        }
      };

      label.appendChild(radio);
      label.appendChild(document.createTextNode(` ${room}`));
      roomList.appendChild(label);
      roomList.appendChild(document.createElement("br"));
    });

  }

  function backToFloors() {

    selectedFloor = null;
    showFloors();

  }


  // ============================================================= Modal Dropdorn=====================================================================

  function toggleDropdown() {
    let dropdown = document.getElementById("dropdown-content");
    let isVisible = dropdown.style.display === "block";
    console.log(`${isVisible}`);

    dropdown.style.display = isVisible ? "none" : "block";
    console.log(`üìÇ Dropdown ${isVisible ? "close" : "open"}`);

    if (!isVisible) {

      showFloors();

      if(selectedRoom) {

        const roomObj = rooms.find(room => room.name === selectedRoom);

        if(roomObj) {
          console.log("Have roomObj: " + roomObj);
          selectedFloor = roomObj.floor;
          showRoomsByFloor(selectedFloor);
          // return;

        }

      } else {
        selectedFloor = "3";
        showRoomsByFloor("3");

      }

    }

  }


  // close dropdown room
  document.addEventListener("click", function(event) {

    const dropdown =  document.getElementById("dropdown-content");

    if (dropdown && !event.target.closest(".dropdown") && !event.target.closest(".floor-item")) {
      dropdown.style.display = "none";
      // console.log("üìå ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏≠‡∏Å -> ‡∏õ‡∏¥‡∏î Dropdown");
    }

  });

  // ============================================================= Get modal data =====================================================================


  function getProjectEditProposalByProjectId(projectId) {

    fetch(`http://localhost:8080/admin/getProjectEditProposalByProjectId?projectId=${encodeURIComponent(projectId)}`, {

      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
      },
    })
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok ' + response.statusText);
                alert('Network response was not ok ' + response.statusText);
              }
              return response.json();
            })
            .then(data => {
              console.log("üêçdata: ", data);

              if(data.length === 0) {
                console.log("No data available");

              } else {

                const cardPop = document.querySelector(".card-popup");
                const modalBody = document.querySelector(".modal-body");

                data.forEach(project => {

                  let advisor = "";
                  let committee = "";

                  if (typeof project.instructorNames === "object") {

                    advisor = project.instructorNames.Advisor ? {name: project.instructorNames.Advisor[0]} : null;
                    committee = project.instructorNames.Committee || [];
                  }

                  const committeeList = committee.map(instructor =>`

                            <div class="student-card">
                                <div class="student-name">${instructor}</div>
                                <div class="student-details">Committee</div>
                            </div>
                      `).join("");

                  let projectId = project.projectId;
                  let cleanId = projectId.replace(/DST|ICT/g, '').trim();

                  let timeSlot = "";
                  let FormattedDate = "";
                  let newStartTime = "";
                  let newEndTime = "";
                  if (project.startTime && project.endTime != null) {
                    // JavaScript Date object
                    const startTime = new Date(project.startTime);
                    const endTime = new Date(project.endTime);
                    timeSlot = `${String(startTime.getHours()).padStart(2, '0')}:${String(startTime.getMinutes()).padStart(2, '0')} - ${String(endTime.getHours()).padStart(2, '0')}:${String(endTime.getMinutes()).padStart(2, '0')}`;
                    console.log("üï∞Ô∏è timeSlot: ", timeSlot);
                    console.log("startTime: ", startTime);
                    console.log("endTime: ", endTime);

                    newStartTime = `${String(startTime.getHours()).padStart(2, '0')}:${String(startTime.getMinutes()).padStart(2, '0')}`;
                    newEndTime = `${String(endTime.getHours()).padStart(2, '0')}:${String(endTime.getMinutes()).padStart(2, '0')}`;

                  }

                  selectedRoom = project.room || "";

                  cardPop.innerHTML = `
                          <input type="hidden" id="hiddenInfo" name="projectId" value="${projectId}">
                          <div class="card-header">
                              <h1 class="card-title">${cleanId}</h1>
                              <div class="tag ${project.program.toLowerCase()}">${project.program}</div>
                          </div>

                          <div class="project-info">
                            <p><strong>Project Title : </strong>${project.projectTitle}</p>
                          </div>

                         <div class="students-section">
                            <h2 class="section-title">Instructor</h2>

                           ${advisor
                          ?`
                            <div class="student-card">
                                <div class="student-name">${advisor.name}</div>
                                <div class="student-details">Advisor</div>
                            </div>
                            `
                          : ''}
                            ${committeeList}
                        </div>

                        <div class="modal-body">
                            <label>Start Date:</label>
                            <input type="date" class="custom-input" id="start-date" value="${project.date ? project.date : '' }"/><br>

                            <label>Time Start :</label>
                            <input type="time" class="custom-input" value="${newStartTime ? newStartTime : ''}"><br>

                            <label>End Start :</label>
                            <input type="time" class="custom-input" value="${newEndTime ? newEndTime : ''}"><br>

                            <label>Room: </label>
                            <div class="dropdown">

                                <button id="selected-label" onclick="toggleDropdown()">
                                    <span id="selected-text">${selectedRoom || "Select Room"}</span>
                                </button>

                                <div class="dropdown-content upward" id="dropdown-content">

                                    <div class="dropdown-header">
                                      <div id="back-button" onclick="backToFloors()">
                                        <span style="font-size: 20px">&larr;</span>
                                      </div>
                                      <h4 id="floor-title">Select Floor</h4>
                                    </div>

                                     <div id="search-container">
                                           <input type="text" id="search" placeholder="Search room" onkeyup="filterRooms()">
                                     </div>

                                      <div id="room-list"></div>
                                </div>
                            </div>
                        </div>

                            <div class="modal-footer">
                                <button id="saveBtn">Save</button>
                                <button id="cancelBtn">Cancel</button>
                            </div>
                      `;

                  fetchData();
                })
              }
            })
            .catch(error => {
              console.error('Error fetching data:', error);

              Swal.fire({
                icon: "error",
                title: "Oops...",
                text: "Something went wrong!",
              });
            });
  }


  // setting
  document.addEventListener('DOMContentLoaded', function () {

    document.querySelector('.card-popup').addEventListener("click", function (e) {

      if(e.target.id.includes("saveBtn") ){

        // send value to controlller
        let projectId = document.querySelector("#hiddenInfo").value;
        console.log("‚ùóÔ∏èDo you want to edit project id " + projectId);
        // let projectId = document.querySelector(".card-title").textContent;
        let cardTitle = document.querySelector(".card-header");
        let programDiv =cardTitle.querySelector(".tag").textContent.trim();
        let startDateInput = document.querySelector("input[type='date']");
        let startTimeInput = document.querySelector("input[type='time']");
        let endTimeInput = document.querySelectorAll("input[type='time']")[1];
        let selectedRoomFinal = selectedRoom && selectedRoom !== "Select Room" ? selectedRoom : null;

        let startDate = startDateInput.value;
        let startTime = startTimeInput.value;
        let endTime = endTimeInput.value;

        let startDateTime = new Date(`${startDate}T${startTime}`)
        let endDateTime = new Date(`${startDate}T${endTime}`)

        console.log("üï∞Ô∏è Check StartTime & EndTime: " + startDateTime + " - " + endDateTime);


        if (!startDate || !startTime || !endTime || !selectedRoomFinal) {
          Swal.fire({
            icon: "warning",
            title: "Oops...",
            text: "Please fill in all information.",
            draggable: true,
            confirmButtonColor: "#dc7633"
          });
          return;
        }

        if(startDateTime >= endDateTime) {
          Swal.fire({
            icon: "warning",
            title: "Oops...",
            text: "Start time must be before end time.",
            draggable: true,
            confirmButtonColor: "#dc7633"
          });
          return;
        }

        let settingData = {
          projectId: projectId,
          program: programDiv,
          startDate: startDate,
          startTime: startTime,
          endTime: endTime,
          room: selectedRoomFinal,
        };

        console.log("üì§ settingData: ", settingData);
        document.getElementById("modalLoaderOverlay").style.display = "flex";

        let csrfToken = document.getElementById("csrfToken").value;

        fetch('http://localhost:8080/admin/EditProposalByProjectId', {

          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRF-TOKEN': csrfToken
          },
          body: JSON.stringify(settingData)

        })
                .then(response =>
                        response.json()
                )
                .then(data => {
                  console.log("üêçdata: ", data);
                  document.getElementById("modalLoaderOverlay").style.display = "none";

                  if(data.hasErrorSaveData) {
                    Swal.fire({
                      icon: "error",
                      title: "Oops...",
                      text: "Sorry, we couldn't save the data",
                    });
                  }

                  if(!data.hasRoomConflict && !data.hasInstructorConflict) {
                    Swal.fire({
                      icon: "success",
                      title: "Save data successfully.",
                      showConfirmButton: false,
                      timer: 2000
                    }).then(() => {
                      window.location.reload();
                    });
                    return;
                  }

                  let conflictHtml = '<div class="conflict-container">';

                  if(data.hasRoomConflict && data.roomConflicts.length > 0) {

                    conflictHtml += `
                          <div class="conflict-section">
                                  <h4 class="conflict-title">Room Conflict</h4>
                                  <div class="conflict-list">
                      `;

                    const dateGroups = {};
                    data.roomConflicts.forEach(conflict => {
                      const startTimeParts = conflict.conflictStartTime.split(':');
                      const endTimeParts = conflict.conflictEndTime.split(':');
                      const timeSlot = `${startTimeParts[0]}:${startTimeParts[1]} - ${endTimeParts[0]}:${endTimeParts[1]}`;

                      const getDate = new Date(conflict.date);
                      let nameDay = getDate.toLocaleDateString('en-us', {weekday: 'short'})
                      let month = getDate.toLocaleDateString('en-us', {month: 'short'})
                      let date = getDate.toLocaleDateString('en-us', {day: 'numeric'})
                      let year = getDate.toLocaleDateString('en-us', {year: 'numeric'})

                      // FormattedDate = `${nameDay} ${month} ${date}, ${year}`
                      FormattedDate = `${nameDay}, ${date} ${month}. ${year}`
                      console.log("üóìÔ∏è getDate: ", getDate);
                      console.log("FormattedDate: ", FormattedDate);

                      if(!dateGroups[FormattedDate]) {
                        dateGroups[FormattedDate] = [];
                      }

                      dateGroups[FormattedDate].push({
                        room: conflict.room,
                        project: conflict.projectId,
                        time: timeSlot
                      });
                    });

                    Object.keys(dateGroups).forEach((date, dateIndex) => {

                      conflictHtml += `
                            <div class="conflict-group">
                              <div class="conflict-date">Date: ${date}</div>
                          `;

                      dateGroups[date].forEach(item => {
                        conflictHtml += `
                              <div class="conflict-item">
                                   <span class="conflict-bullet"></span>
                                   <span class="conflict-content">Room: ${item.room}</span>
                              </div>

                               <div class="conflict-item">
                                  <span class="conflict-bullet"></span>
                                  <span class="conflict-content">Project: ${item.project}</span>
                                </div>

                                <div class="conflict-time">
                                  <span class="conflict-time-icon">‚è∞</span>
                                  <span>Time: ${item.time}</span>
                                </div><br>
                          `;
                      });
                      conflictHtml += `</div>`;
                    })

                    conflictHtml += `
                            </div>
                        </div>
                      `;
                  }

                  if(data.instructorConflicts && data.instructorConflicts.length > 0) {

                    conflictHtml += `
                          <div class="conflict-section">
                                  <h4 class="conflict-title">Instructor Conflict</h4>
                                  <div class="conflict-list">
                      `;

                    const instructorGroups = {};
                    data.instructorConflicts.forEach(conflict => {

                      if(!instructorGroups[conflict.instructorName]) {
                        instructorGroups[conflict.instructorName] = [];
                      }

                      const startTimeParts = conflict.conflictStartTime.split(':');
                      const endTimeParts = conflict.conflictEndTime.split(':');
                      const timeSlot = `${startTimeParts[0]}:${startTimeParts[1]} - ${endTimeParts[0]}:${endTimeParts[1]}`;

                      instructorGroups[conflict.instructorName].push({
                        project: conflict.conflictingProjectId,
                        date: conflict.conflictingDate,
                        time: timeSlot
                      });
                    });

                    Object.keys(instructorGroups).forEach(instructor => {
                      conflictHtml += `
                            <div class="conflict-group">
                              <div class="conflict-instructor">${instructor}</div>
                          `;

                      instructorGroups[instructor].forEach(item => {
                        conflictHtml += `
                              <div class="conflict-item">
                                <span class="conflict-bullet"></span>
                                <span class="conflict-content">Project: ${item.project}</span>
                              </div>

                              <div class="conflict-item">
                                <span class="conflict-bullet"></span>
                                <span class="conflict-content">Date: ${item.date}</span>
                              </div>

                              <div class="conflict-time">
                                  <span class="conflict-time-icon">‚è∞</span>
                                  <span>Time: ${item.time}</span>
                                </div><br>
                                `;
                      });

                      conflictHtml += '</div>';
                    });

                    conflictHtml += `
                            </div>
                          </div>
                        `;
                  }

                  conflictHtml += '</div>';

                  Swal.fire({
                    icon: "warning",
                    title: "Schedule overlap found",
                    html: conflictHtml,
                    showCancelButton: true,
                    showConfirmButton: false,
                    cancelButtonColor: "#d33",
                    cancelButtonText: "Close"
                  })

                })
                .catch(error => {
                  document.getElementById("modalLoaderOverlay").style.display = "none";
                  console.error('Error fetching data:', error);
                  Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    text: "Something went wrong!",
                  });
                });

      }
    });

  });


</script>


<!-- ----------- Set Header Value -------------- -->
<script>

  const semesterSelect = document.getElementById("semester-selector");
  semesterSelect.addEventListener("change", function () {
    console.log("Selected Semester:", semesterSelect.value);

    localStorage.setItem("selectedSemester", semesterSelect.value);

    getProjectEditProposal();

  });

  // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ event listeners
  document.addEventListener("DOMContentLoaded", function () {
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö semester selector
    const semesterSelect = document.getElementById("semester-selector");
    semesterSelect.addEventListener("change", function () {
      console.log("Selected Semester:", semesterSelect.value);
    });
  });
</script>

<!-- --------- Semester Change ------------- -->
<script>
  async function fetchAcademicYears() {
    try {
      const response = await fetch('/api/academic-years'); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
      const data = await response.json();

      console.log("Year: ", data);

      const semesterSelector = document.getElementById('semester-selector');
      semesterSelector.innerHTML = ""; // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Ñ‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡∏°‡πà

      data.forEach(year => {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = "üìÜ "+year;
        // option.innerHTML = `<!--<i class='far fa-calendar'></i> ${year} <i class='fas fa-chevron-down dropdown-arrow'></i>-->`;
        semesterSelector.appendChild(option);
      });

      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      const currentDate = new Date();
      const currentYear = currentDate.getFullYear();
      const currentMonth = currentDate.getMonth() + 1; // getMonth() ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 0-11 (‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° = 0, ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° = 11)

      // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô <= 6 (‡∏°.‡∏Ñ. - ‡∏°‡∏¥.‡∏¢.) ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô -1, ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô ‡∏Å.‡∏Ñ. ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
      const defaultYear = currentMonth <= 8 ? currentYear - 1 : currentYear;

      // // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      // if (data.includes(defaultYear.toString())) {
      //   semesterSelector.value = defaultYear.toString();
      //   console.log("yearrrrrrrrrrrrrr : ",document.getElementById('semester-selector').value)
      // } else {
      //   semesterSelector.selectedIndex = 0; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏µ‡∏ô‡∏±‡πâ‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡πÅ‡∏ó‡∏ô
      // }

      const savedSemester = localStorage.getItem("selectedSemester");

      if (savedSemester && data.includes(savedSemester)) {
        semesterSelector.value = savedSemester;
      } else if (data.includes(defaultYear.toString())) {
        semesterSelector.value = defaultYear.toString();
      } else {
        semesterSelector.selectedIndex = 0;
      }

      await getProjectEditProposal();


    } catch (error) {
      console.error("Error fetching academic years:", error);
    }
  }
  fetchAcademicYears();
</script>